p8105_hw2_yl4924
================
Yongzheng Li
2022-10-02

# load the package

``` r
library(tidyverse)
```

    ## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──
    ## ✔ ggplot2 3.3.6      ✔ purrr   0.3.4 
    ## ✔ tibble  3.1.8      ✔ dplyr   1.0.10
    ## ✔ tidyr   1.2.0      ✔ stringr 1.4.1 
    ## ✔ readr   2.1.2      ✔ forcats 0.5.2 
    ## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
    ## ✖ dplyr::filter() masks stats::filter()
    ## ✖ dplyr::lag()    masks stats::lag()

``` r
library(readxl)
```

# Problem 1

### import and clean the data

``` r
nyc_transit_data <- read_csv("./data/NYC_Transit_Subway_Entrance_And_Exit_Data.csv",  
                    col_types = cols(Route8 = "c", Route9 = "c", Route10 = "c", Route11 = "c")) %>% 
                    janitor::clean_names() %>%
                    select(line, station_name, station_latitude, station_longitude, 
                           starts_with("routes"), entry, vending, entrance_type,ada) %>% 
                    mutate(ifelse(entry == "Yes", TRUE, FALSE))
```

# Problem 2

### Read and clean the Mr. Trash Wheel sheet

Variable ‘year’ in Mr. Trash Wheel is character variable. I decide to
convert year to numerical variable.

``` r
mr_trash <- read_excel("./data/Trash Wheel Collection Data.xlsx", range = "A2:N549", sheet = "Mr. Trash Wheel" ) %>% 
            janitor::clean_names() %>% 
            mutate(
              sports_balls = round(sports_balls),
              sports_balls = as.integer(sports_balls),
              year = as.numeric(year))
```

### Read and clean the Professor Trash Wheel sheet

``` r
professor_trash <- read_excel("./data/Trash Wheel Collection Data.xlsx", range = "A2:M96", sheet = "Professor Trash Wheel") %>% 
                   janitor::clean_names() %>% 
                   mutate(
                     sports_balls = 0,
                     sports_balls = as.integer(sports_balls)) %>% 
                   relocate(sports_balls, .after = chip_bags)
```

### add additional variable ‘trash_wheel_type’

After view the two datasets, I decide to use binding to combine mr.
trash wheel and professor_trash wheel. Since both datasets have variable
‘dumpster’, I decide to create variable ‘trash_wheel_type’ as the
identity variable.

``` r
mr_trash <- mutate(mr_trash, trash_wheel_type = "Mr")
professor_trash <- mutate(professor_trash, trash_wheel_type = "Professor")
```

### combine two dataset

``` r
trash_tidy <- bind_rows(mr_trash, professor_trash)
```

The combined dataset contain 641 rows and 15 columns. Among 15 columns,
the key variables are weight in tons and volume in cubic yards. The mean
weight of trash collect of the combined data is 3.0241498 tons. The mean
volume of trash collect of the combined data is 15.2199688 cubic yards.
The total weight of trash collected by Professor Trash Wheel = 190.12
tons. The total number of sports balls collected by Mr. Trash Wheel in
2020 is 856.

# Problem 3

### read and clean the data of pols-month.csv

``` r
pols_month <- read_csv("./data/pols-month.csv") %>% 
              janitor::clean_names() %>% 
              separate(mon, into = c("year", "month", "day"), sep = "-") %>% 
              mutate(
                year = as.integer(year),
                month = month.abb[as.integer(month)],
                day = as.integer(day),
                prez_gop = recode(prez_gop, `1` = "gop", `0` = "dem", `2` = "otherwise" ),
                prez_dem = recode(prez_dem, `1` = "dem", `0` = "gop")) %>% 
              pivot_longer(
                cols = c(prez_gop, prez_dem),
                names_to = NULL,
                values_to = "president") %>% 
              select(-contains("prez")) %>% 
              select(-day) %>% 
              distinct()
```

    ## Rows: 822 Columns: 9
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## dbl  (8): prez_gop, gov_gop, sen_gop, rep_gop, prez_dem, gov_dem, sen_dem, r...
    ## date (1): mon
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

### read and clean the data of snp.csv

``` r
snp <- read_csv("./data/snp.csv") %>%
       janitor::clean_names() %>% 
       separate(date, into = c("year", "month", "day"), sep = "/") %>% 
       mutate(
         year = as.integer(year),
         day = as.integer(day),
         month = as.integer(month),
         year_before_2001 = case_when(50 <= day & day <= 99 ~ 1900+day,
                                      day == 0 ~2000+day,
                                      1 <= day & day <= 49 ~ 0),
         
         month = case_when(year_before_2001 > 0 ~ year+0,
                           year_before_2001 == 0 ~ month+0),
         month = month.abb[month],
         
         year = case_when(year_before_2001 == 0 ~ 2000+year,
                          year_before_2001 > 0 ~ 0+year_before_2001)) %>% 
      select(-c(day,year_before_2001))
```

    ## Rows: 787 Columns: 2
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (1): date
    ## dbl (1): close
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
head(snp)
```

    ## # A tibble: 6 × 3
    ##    year month close
    ##   <dbl> <chr> <dbl>
    ## 1  2007 Jan   2080.
    ## 2  2006 Jan   2063.
    ## 3  2005 Jan   2107.
    ## 4  2004 Jan   2086.
    ## 5  2003 Feb   2068.
    ## 6  2002 Feb   2104.

I noticed the date in years after 2001(yyyy/mm/dd) is different from
date in years before 2001(mm/dd/yy). I decide to create a new variable
‘year_before_2001’ used to seperate years before 2001 and after 2001.
Then I mutate month for years before 2001(from mm/dd/yy to mm/mm/yy
since we do not need day so I just override it) Next, I mutate years for
years before 2001 based on the variable ‘year_before_2001’ (from
mm/mm/yy to yyyy/mm/yy) and change years to 4 digit for years after
2001. Finally, I drop the variable ‘day’ and variable ‘year_before_2001’
to keep the columns I need.

### tidy the unemployment data

``` r
unemployment <- read_csv("./data/unemployment.csv") %>% 
                pivot_longer(
                  cols = Jan:Dec,
                  names_to = "month",
                  values_to = "percentage") %>% 
                janitor::clean_names()
```

    ## Rows: 68 Columns: 13
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## dbl (13): Year, Jan, Feb, Mar, Apr, May, Jun, Jul, Aug, Sep, Oct, Nov, Dec
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

### join the dataset

``` r
fte_data <- left_join(pols_month, snp, by = c("year", "month") ) %>% 
left_join(unemployment, by = c("year", "month"))
head(fte_data)
```

    ## # A tibble: 6 × 11
    ##    year month gov_gop sen_gop rep_gop gov_dem sen_dem rep_dem president close
    ##   <dbl> <chr>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl> <chr>     <dbl>
    ## 1  1947 Jan        23      51     253      23      45     198 dem          NA
    ## 2  1947 Feb        23      51     253      23      45     198 dem          NA
    ## 3  1947 Mar        23      51     253      23      45     198 dem          NA
    ## 4  1947 Apr        23      51     253      23      45     198 dem          NA
    ## 5  1947 May        23      51     253      23      45     198 dem          NA
    ## 6  1947 Jun        23      51     253      23      45     198 dem          NA
    ## # … with 1 more variable: percentage <dbl>

the data pols_month contain the number of national politicians who are
democratic or republican from 1947 to 2015. Data snp contain information
of closing value of stock market index from 1950 to 2012. Data
unemployment contain the information of percent of unemployment from
1948 to 2015. The combined data fte_data contain 965 rows and 11
columns. the range of years is from 1947 to 2015. The key variables is
president, close, and percentage.
